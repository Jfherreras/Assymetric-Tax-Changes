#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
# lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
# 29. d_tax_inc
# 30. profit_rate1
# 31. profit_rate2
# 32. profit_rate3
# 33. profit_rate4
# 36. output_gap
# 37. pos_gap
# 38. neg_gap
# Panel["gdp"] = log(Panel$gdp)
# (4/25) Tax -> (30/31/32/33)Profit -> (20/21/22)Wages -> (10/11/12) Inequity -> (23) growth | GAP
endog_data <- Panel[,c(21,2,4,30,20,10,23,3,37)]
# Using dummy
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "gini", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "pos_gap",
# lag_switching     = TRUE,
# use_hp         = TRUE,
# lambda            = 6.25,
# gamma          = 10,
confint = 1.67,
hor = 12)
# Using dummy
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "gini", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "pos_gap",
lag_switching     = FALSE,
# use_hp         = TRUE,
# lambda            = 6.25,
# gamma          = 10,
confint = 1.67,
hor = 12)
# Using dummy
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "gini", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "pos_gap",
lag_switching     = TRUE,
# use_hp         = TRUE,
# lambda            = 6.25,
gamma          = 10,
confint = 1.67,
hor = 12)
plots = plot_nl(results_panel)
# Using dummy
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "gini", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
use_logistic = FALSE
switching = "pos_gap",
# lag_switching     = TRUE,
# use_hp         = TRUE,
# lambda            = 6.25,
# gamma          = 10,
confint = 1.67,
hor = 12)
# Using dummy
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "gini", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
use_logistic = FALSE,
switching = "pos_gap",
# lag_switching     = TRUE,
# use_hp         = TRUE,
# lambda            = 6.25,
# gamma          = 10,
confint = 1.67,
hor = 12)
# 29. d_tax_inc
# 30. profit_rate1
# 31. profit_rate2
# 32. profit_rate3
# 33. profit_rate4
# 36. output_gap
# 37. pos_gap
# 38. neg_gap
# Panel["gdp"] = log(Panel$gdp)
# (4/25) Tax -> (30/31/32/33)Profit -> (20/21/22)Wages -> (10/11/12) Inequity -> (23) growth | GAP
endog_data <- Panel[,c(24,2,4,30,20,10,23,3,37)]
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "gini", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
plots = plot_nl(results_panel)
plots = plot_nl(results_panel)
x11()
plots = plot_nl(results_panel)
# Using dummy
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "gini", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
use_logistic = FALSE,
switching = "pos_gap",
# lag_switching     = TRUE,
# use_hp         = TRUE,
# lambda            = 6.25,
# gamma          = 10,
confint = 1.67,
hor = 12)
plots = plot_nl(results_panel)
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "gini", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
plots = plot_nl(results_panel)
# IRFs on GINI
results_panel <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
plots = plot_nl(results_panel)
x11()
plots = plot_nl(results_panel)
Panel <- read_dta("G:/Mi unidad/1 Drive Escritorio/Investigaciones/Assymetric impacts of income taxation/Analysis/Output/Datasets/Panel.dta")
library(haven)
Panel <- read_dta("G:/Mi unidad/1 Drive Escritorio/Investigaciones/Assymetric impacts of income taxation/Analysis/Output/Datasets/Panel.dta")
# Load package
library(vctrs)
library(lpirfs)
library(gridExtra)
library(ggpubr)
library(rlang)
# 29. d_tax_inc
# 30. profit_rate1
# 31. profit_rate2
# 32. profit_rate3
# 33. profit_rate4
# 36. output_gap
# 37. pos_gap
# 38. neg_gap
# Panel["gdp"] = log(Panel$gdp)
# (4/25) Tax -> (30/31/32/33)Profit -> (20/21/22)Wages -> (10/11/12) Inequity -> (23) growth | GAP
endog_data <- Panel[,c(24,2,25,30,20,10,23,3,37)]
Panel$corporateincometaxrate <- -Panel$corporateincometaxrate
###########
### Insanity Test
endog_data <- Panel[,c(24,2,4,30,20,11,23,3,37)]
# Smoothing Function
results_panel_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
plot(results_panel_SF)
###########
### Insanity Test
endog_data <- Panel[,c(24,2,4,30,20,11,23,3,37)]
# Smoothing Function
results_panel_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
# Load package
library(vctrs)
library(lpirfs)
# Smoothing Function
results_panel_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
plot(results_panel_SF)
# Load package
library(vctrs)
library(lpirfs)
install.packages("vctrs")
library(lpirfs)
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
install.packages("vctrs")
library(lpirfs)
library(gridExtra)
library(ggpubr)
library(rlang)
###########
### Insanity Test
endog_data <- Panel[,c(24,2,4,30,20,11,23,3,37)]
# Smoothing Function
results_panel_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
Panel$corporateincometaxrate <- -Panel$corporateincometaxrate
######
## IRFs on GROWTH
# Smoothing Function
results_panel_growth_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "tax_change", diff_shock = TRUE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
###########
### Insanity Test
endog_data <- Panel[,c(24,2,4,30,20,11,23,3,37)]
# Smoothing Function
results_panel_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
# Dummy
results_panel_D <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
use_logistic = FALSE,
switching = "pos_gap",
# lag_switching     = TRUE,
# use_hp         = TRUE,
# lambda         = 6.25,
# gamma          = 10,
confint = 1.67,
hor = 12)
Panel$corporateincometaxrate <- -Panel$corporateincometaxrate
###########
### Insanity Test
endog_data <- Panel[,c(24,2,4,30,20,11,23,3,37)]
# Smoothing Function
results_panel_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
plot(results_panel_SF)
# Smoothing Function
results_panel_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
# Smoothing Function
results_panel_SF <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = TRUE,
shock = "corporateincometaxrate", diff_shock = FALSE,
panel_model = "within", panel_effect = "twoways",
robust_cov = "vcovSCC",
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
switching = "gdp",
lag_switching     = TRUE,      use_hp         = TRUE,
lambda            = 6.25,      gamma          = 10,
confint = 1.67,
hor = 12)
# Load package
library(vctrs)
library(lpirfs)
library(gridExtra)
library(ggpubr)
library(rlang)
library(haven)
# Load data
Panel <- read_dta("G:/Mi unidad/1 Drive Escritorio/Investigaciones/Assymetric impacts of income taxation/Analysis/Output/Datasets/Panel.dta")
####### Results considering inequity
# Smoothing Function
# Panel<-na.omit(Panel)
# (4/25) Tax -> (30/31/32/33)Profit -> (20/21/22)Wages -> (10/11/12) Inequity -> (23) growth | GAP
endog_data <- Panel[,c(24,2,4,30,20,7,10,23,3,37,36)]
a = na.omit(endog_data$gini)
gini_mean = mean(a)
gini_quarters = quantile(a)
gini_75 = gini_quarters[4]
gini_med = gini_quarters[3]
gini_25 = gini_quarters[2]
endog_data %>%
group_by(ID) %>%
mutate(gini_m = meadian(gini))
endog_data %>%
group_by(country) %>%
mutate(gini_m = meadian(gini))
endog_data %>%
group_by(country) %>%
mutate(gini_m = quantile(gini)[3])
endog_data %>%
endog_data %>%
group_by(country) %>%
mutate(gini_m = quantile(gini)[3])
endog_data %>%
group_by(country) %>%
mutate(gini_m = quantile(gini))
endog_data %>%
group_by(country) %>%
mutate(gini_m = quantile(gini))
endog_data %>%
group_by(country) %>%
mutate(gini_m = na.omit(quantile(gini)))
dummy = endog_data %>%
dplyr::select(country,gini) %>%
group_by(country) %>%
mutate(gini_q = quantile(gini,3))
dummy = endog_data %>%
dplyr::select(country,gini) %>%
group_by(country) %>%
mutate(gini_q = quantile(na.omit(gini),3))
# Load data
Panel <- read_dta("G:/Mi unidad/1 Drive Escritorio/Investigaciones/Assymetric impacts of income taxation/Analysis/Output/Datasets/Panel.dta")
# Load package
library(vctrs)
library(lpirfs)
library(gridExtra)
library(ggpubr)
library(rlang)
library(haven)
# Load data
Panel <- read_dta("G:/Mi unidad/1 Drive Escritorio/Investigaciones/Assymetric impacts of income taxation/Analysis/Output/Datasets/Panel.dta")
Panel$corporateincometaxrate <- -Panel$corporateincometaxrate # Changing the sign to get -1pp shock
####### Results considering inequity
# Smoothing Function
# Panel<-na.omit(Panel)
# (4/25) Tax -> (30/31/32/33)Profit -> (20/21/22)Wages -> (10/11/12) Inequity -> (23) growth | GAP
endog_data <- Panel[,c(24,2,4,30,20,7,10,23,3,37,36,40)]
# Dummy
results_panel_D <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = T,
shock = "corporateincometaxrate", diff_shock = F,
panel_model = "within",
panel_effect = "individual",
robust_cov = "vcovSCC",
c_exog_data = c("wages_lc","profit_rate1","unemploymentrate","output_gap"),
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
use_logistic = FALSE,
switching = "high_ineq_p75",
# lag_switching     = TRUE,
# use_hp         = TRUE,
# lambda         = 6.25,
# gamma          = 10,
confint = 1.96,
hor = 12)
plot(results_panel_D)
# Dummy
results_panel_D <-  lp_nl_panel(data_set = endog_data,
endog_data = "growth", cumul_mult = T,
shock = "corporateincometaxrate", diff_shock = T,
panel_model = "within",
panel_effect = "individual",
robust_cov = "vcovSCC",
c_exog_data = c("wages_lc","profit_rate1","unemploymentrate","output_gap"),
# robust_maxlag = 2,
#
# use_logistic = FALSE,
# use_gmm = TRUE, gmm_model = "onestep",
use_logistic = FALSE,
switching = "high_ineq_p75",
# lag_switching     = TRUE,
# use_hp         = TRUE,
# lambda         = 6.25,
# gamma          = 10,
confint = 1.96,
hor = 12)
plot(results_panel_D)
